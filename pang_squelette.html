<!doctype html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Carré, déplacement, obstacles, collisions</title>
    <script>
    // ------------------------------
    //  Variables
    // ------------------------------

    // context
    var context = null;

    // player
    var player = {position: {x: 0, y: 0}, height: 0, width: 0, powerOn: 0, shieldOn: 0, score: 0, livesNumber: 3};

    // ------------------------------
    //  Functions
    // ------------------------------

    // ------------------------------
    //  Game
    // ------------------------------

    /**
     * Initialisation
     */
    init = function() {
        // instanciation de la variable globale contenant le contexte
        context = document.getElementById("cvs").getContext("2d");
        context.width = document.getElementById("cvs").width;
        context.height = document.getElementById("cvs").height;

        // écouteurs
        document.addEventListener("keydown", captureAppuiToucheClavier)
        document.addEventListener("keyup", captureRelacheToucheClavier)

        // initialisation du joueur
        player.height = 75;
        player.width = 75;
        player.position.x = context.width/2 - player.width/2;
        player.position.y = context.height - player.height;

        // lancement de la boucle de jeu
        boucleDeJeu();
    }

    /*
     * Game loop
     */
    boucleDeJeu = function() {
        // mise à jour de l'état du jeu
        update(Date.now());

        // affichage de l'état du jeu
        render();

        // rappel de la boucle de jeu
        //  http://www.html5canvastutorials.com/advanced/html5-canvas-animation-stage/
        requestAnimationFrame(boucleDeJeu);
    }


    /**
     *  Mise à jour de l'état du jeu
     *  @param  d   date courante
     */
    update = function(d) {

    }


    /**
     *  Fonction réalisant le rendu de l'état du jeu
     */
    render = function() {
        // effacement de l'écran
        context.clearRect(0, 0, context.width, context.height);

        // affichage du joueur
        context.fillStyle = "black";
        context.fillRect(player.position.x, player.position.y, player.height, player.width);
    }


    /**
     *  Fonction appelée lorsqu'une touche du clavier est appuyée
     *  Associée à l'événement "keyDown"
     */
    captureAppuiToucheClavier = function(event) {
        // pratique pour connaître les keyCode des touches du clavier :
        //  --> http://www.cambiaresearch.com/articles/15/javascript-key-codes
    }

    /**
     *  Fonction appelée lorsqu'une touche du clavier est relâchée
     *  Associée à l'événement "keyUp"
     */
    captureRelacheToucheClavier = function(event) {

    }

    </script>
</head>

<body onload="init()">

    <canvas id="cvs" width="800" height="600" style="margin: 10px auto; border: solid 1px #000;"></canvas>

</body>

</html>
